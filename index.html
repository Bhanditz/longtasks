<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Long Tasks API</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in Â§N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em 0;
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: normal;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li li { font-size:   85%;    }

	.toc > li             { margin: 1.5rem 0;    }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	.toc .secno {
		float: left;
		width: 4rem;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 951ee1daf34f62c5f94e8eaae01dfcf902b0487c" name="generator">
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "Â¶"; }
            .heading > a.self-link::before { content: "Â§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figcaption {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure) " ";
            }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "â";
            }
            .css::after, .property::after, .descriptor::after {
                content: "â";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "â";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "â";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
        .highlight:not(.idl) { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        .highlight .c { color: #708090 } /* Comment */
        .highlight .k { color: #990055 } /* Keyword */
        .highlight .l { color: #000000 } /* Literal */
        .highlight .n { color: #0077aa } /* Name */
        .highlight .o { color: #999999 } /* Operator */
        .highlight .p { color: #999999 } /* Punctuation */
        .highlight .cm { color: #708090 } /* Comment.Multiline */
        .highlight .cp { color: #708090 } /* Comment.Preproc */
        .highlight .c1 { color: #708090 } /* Comment.Single */
        .highlight .cs { color: #708090 } /* Comment.Special */
        .highlight .kc { color: #990055 } /* Keyword.Constant */
        .highlight .kd { color: #990055 } /* Keyword.Declaration */
        .highlight .kn { color: #990055 } /* Keyword.Namespace */
        .highlight .kp { color: #990055 } /* Keyword.Pseudo */
        .highlight .kr { color: #990055 } /* Keyword.Reserved */
        .highlight .kt { color: #990055 } /* Keyword.Type */
        .highlight .ld { color: #000000 } /* Literal.Date */
        .highlight .m { color: #000000 } /* Literal.Number */
        .highlight .s { color: #a67f59 } /* Literal.String */
        .highlight .na { color: #0077aa } /* Name.Attribute */
        .highlight .nc { color: #0077aa } /* Name.Class */
        .highlight .no { color: #0077aa } /* Name.Constant */
        .highlight .nd { color: #0077aa } /* Name.Decorator */
        .highlight .ni { color: #0077aa } /* Name.Entity */
        .highlight .ne { color: #0077aa } /* Name.Exception */
        .highlight .nf { color: #0077aa } /* Name.Function */
        .highlight .nl { color: #0077aa } /* Name.Label */
        .highlight .nn { color: #0077aa } /* Name.Namespace */
        .highlight .py { color: #0077aa } /* Name.Property */
        .highlight .nt { color: #669900 } /* Name.Tag */
        .highlight .nv { color: #222222 } /* Name.Variable */
        .highlight .ow { color: #999999 } /* Operator.Word */
        .highlight .mb { color: #000000 } /* Literal.Number.Bin */
        .highlight .mf { color: #000000 } /* Literal.Number.Float */
        .highlight .mh { color: #000000 } /* Literal.Number.Hex */
        .highlight .mi { color: #000000 } /* Literal.Number.Integer */
        .highlight .mo { color: #000000 } /* Literal.Number.Oct */
        .highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
        .highlight .sc { color: #a67f59 } /* Literal.String.Char */
        .highlight .sd { color: #a67f59 } /* Literal.String.Doc */
        .highlight .s2 { color: #a67f59 } /* Literal.String.Double */
        .highlight .se { color: #a67f59 } /* Literal.String.Escape */
        .highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
        .highlight .si { color: #a67f59 } /* Literal.String.Interpol */
        .highlight .sx { color: #a67f59 } /* Literal.String.Other */
        .highlight .sr { color: #a67f59 } /* Literal.String.Regex */
        .highlight .s1 { color: #a67f59 } /* Literal.String.Single */
        .highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
        .highlight .vc { color: #0077aa } /* Name.Variable.Class */
        .highlight .vg { color: #0077aa } /* Name.Variable.Global */
        .highlight .vi { color: #0077aa } /* Name.Variable.Instance */
        .highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
        </style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Long Tasks API</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Community Group Report, <time class="dt-updated" datetime="2017-02-05">5 February 2017</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/longtasks/">https://wicg.github.io/longtasks/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/wicg/longtasks/issues/">GitHub</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:panicker@chromium.org">Shubhie Panicker</a> (<span class="p-org org">Google (https://google.com)</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:igrigorik@chromium.org">Ilya Grigorik</a> (<span class="p-org org">Google (https://google.com)</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:domenic@chromium.org">Domenic Denicola</a> (<span class="p-org org">Google (https://google.com)</span>)
     <dt>Tests:
     <dd><span>FIXME</span>
    </dl>
   </div>
   <div data-fill-with="warning">
    <details class="annoying-warning" open="">
     <summary>Not Ready For Implementation</summary>
     <p> This spec is not yet ready for implementation.
		It exists in this repository to record the ideas and promote discussion. </p>
     <p> Before attempting to implement this spec,
		please contact the editors. </p>
    </details>
   </div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> Â© 2015 the Contributors to the Long Tasks API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This document defines an API that web page authors can use to detect presence of âlong tasksâ that monopolize the UI thread for extended periods of time and block other critical tasks from being executed - e.g. reacting to user input.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
   <p>If you wish to make comments regarding this document, please send them to <a href="mailto:public-web-perf@w3.org?subject=%5BLongTasks%5D">public-web-perf@w3.org</a> (<a href="mailto:public-web-perf-request@w3.org?subject=subscribe">subscribe</a>, <a href="https://lists.w3.org/Archives/Public/public-web-perf/">archives</a>) with <code>[LongTasks]</code> at the start of your emailâs subject.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#example"><span class="secno">1.1</span> <span class="content">Usage Example</span></a>
     </ol>
    <li><a href="#sec-terminology"><span class="secno">2</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#sec-longtask-timing"><span class="secno">3</span> <span class="content">Long Task Timing</span></a>
     <ol class="toc">
      <li><a href="#sec-PerformanceLongTaskTiming"><span class="secno">3.1</span> <span class="content"><code class="idl highlight"><span>PerformanceLongTaskTiming</span></code> interface</span></a>
      <li><a href="#sec-TaskAttributionTiming"><span class="secno">3.2</span> <span class="content"><code class="idl highlight"><span>TaskAttributionTiming</span></code> interface</span></a>
      <li><a href="#sec-PointingToCulprit"><span class="secno">3.3</span> <span class="content">Pointing to the culprit</span></a>
     </ol>
    <li>
     <a href="#sec-processing-model"><span class="secno">4</span> <span class="content">Processing Model</span></a>
     <ol class="toc">
      <li>
       <a href="#mod"><span class="secno">4.1</span> <span class="content">Modifications to other specifications</span></a>
       <ol class="toc">
        <li><a href="#html-event-loop-dfn"><span class="secno">4.1.1</span> <span class="content">HTML: <span>event loop definitions</span></span></a>
        <li><a href="#html-event-loop-processing"><span class="secno">4.1.2</span> <span class="content">HTML: <span>event loop processing model</span></span></a>
        <li><a href="#html-calling-scripts"><span class="secno">4.1.3</span> <span class="content">HTML: <span>calling scripts</span></span></a>
       </ol>
      <li>
       <a href="#sec-additions-to-spec"><span class="secno">4.2</span> <span class="content">Additions to the Long Task Spec</span></a>
       <ol class="toc">
        <li><a href="#report-long-tasks"><span class="secno">4.2.1</span> <span class="content">Report Long Tasks</span></a>
       </ol>
     </ol>
    <li><a href="#priv-sec"><span class="secno">5</span> <span class="content">Security and Privacy Considerations</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p>As the page is loading and while the user is interacting with the page afterwards, both the application and browser, queue various events that are then executed by the browser -- e.g. user agent schedules input events based on userâs activity, the application schedules callbacks for requestAnimationFrame and other callbacks etc. Once in the queue, these events are then dequeued one-by-one by the browser and executed.</p>
   <p>However, some task can take a long time (multiple frames), and if and when that happens, the UI thread is locked and all other tasks are blocked as well. To the user this is commonly visible as a âlocked upâ page where the browser is unable to respond to user input; this is a major source of bad user experience on the web today:</p>
   <dl>
    <dt data-md="">
     <p>Delayed âtime to Interactiveâ:</p>
    <dd data-md="">
     <p>while the page is loading long tasks often tie up the main thread and prevent the user from interactive with the page even though the page is visually rendered. Poorly designed third-party content is a frequent culprit.</p>
    <dt data-md="">
     <p>High/variable input latency:</p>
    <dd data-md="">
     <p>critical user interaction events (tap, click, scroll, wheel, etc) are queued behind long tasks, which yields janky and unpredictable user experience.</p>
    <dt data-md="">
     <p>High/variable event handling latency:</p>
    <dd data-md="">
     <p>similar to input, but for processing event callbacks (e.g. onload events, and so on), which delay application updates.</p>
    <dt data-md="">
     <p>Janky animations and scrolling:</p>
    <dd data-md="">
     <p>some animation and scrolling interactions require coordination between compositor and main threads; if the main thread is blocked due to a long task, it can affect responsiveness of animations and scrolling.</p>
   </dl>
   <p>Some applications (and RUM vendors) are already attempting to identify and track cases where âlong tasksâ happen. For example, one known pattern is to install a ~short periodic timer and inspect the elapsed time between the successive calls: if the elapsed time is greater than the timer period, then there is high likelihood that one or more long tasks have delayed execution of the timer. This mostly works, but it has several bad performance implications: the application is polling to detect long tasks, which prevents quiescence and long idle blocks (see requestIdleCallback); itâs bad for battery life; there is no way to know who caused the delay (e.g. first party vs third party code)</p>
   <p>RAIL performance model suggests that applications should respond in under 100ms to user input; for touch move and scrolling in under 16ms. Our goal with this API is to surface notifications about tasks that may prevent the application from hitting these targets.</p>
   <h3 class="heading settled" data-level="1.1" id="example"><span class="secno">1.1. </span><span class="content">Usage Example</span><a class="self-link" href="#example"></a></h3>
<pre class="example highlight" id="example-79af7d22"><a class="self-link" href="#example-79af7d22"></a><span class="kd">var</span> observer <span class="o">=</span> <span class="k">new</span> PerformanceObserver<span class="p">(</span><span class="kd">function</span><span class="p">(</span>list<span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> perfEntries <span class="o">=</span> list<span class="p">.</span>getEntries<span class="p">(</span><span class="p">)</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> i <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> i <span class="o">&lt;</span> perfEntries<span class="p">.</span>length<span class="p">;</span> i<span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Process long task notifications:
</span>        <span class="c1">// report back for analytics and monitoring
</span>        <span class="c1">// ...
</span>    <span class="p">}</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>
<span class="c1">// register observer for long task notifications
</span>observer<span class="p">.</span>observe<span class="p">(</span><span class="p">{</span>entryTypes<span class="o">:</span> <span class="p">[</span><span class="s2">"longtask"</span><span class="p">]</span><span class="p">}</span><span class="p">)</span><span class="p">;</span>
<span class="c1">// Long script execution after this will result in queueing
</span><span class="c1">// and receiving âlongtaskâ entries in the observer.
</span></pre>
   <h2 class="heading settled" data-level="2" id="sec-terminology"><span class="secno">2. </span><span class="content">Terminology</span><a class="self-link" href="#sec-terminology"></a></h2>
   <p><dfn data-dfn-type="dfn" data-export="" id="long-task">Long task<a class="self-link" href="#long-task"></a></dfn> refers to an event loop task that exceeds 50ms.</p>
   <p><dfn data-dfn-type="dfn" data-noexport="" id="frame">Frame<a class="self-link" href="#frame"></a></dfn> or <dfn data-dfn-type="dfn" data-noexport="" id="frame-context">frame context<a class="self-link" href="#frame-context"></a></dfn> refers to the browsing context, such as iframe (not animation frame), embed or object in which some work (such as script or layout) occurs.</p>
   <p><dfn data-dfn-type="dfn" data-noexport="" id="culprit-frame">Culprit frame<a class="self-link" href="#culprit-frame"></a></dfn> refers to the browsing context (iframe, embed or object etc) that is being implicated, on the whole, for a long task.</p>
   <p><dfn data-dfn-type="dfn" data-noexport="" id="attribution">Attribution<a class="self-link" href="#attribution"></a></dfn> refers to identifying the type of work (such as script, layout etc.) that contributed significantly to the long task AND which browsing context is responsible for that work.</p>
   <h2 class="heading settled" data-level="3" id="sec-longtask-timing"><span class="secno">3. </span><span class="content">Long Task Timing</span><a class="self-link" href="#sec-longtask-timing"></a></h2>
   <p>Long Task timing involves the following new interfaces</p>
   <h3 class="heading settled" data-level="3.1" id="sec-PerformanceLongTaskTiming"><span class="secno">3.1. </span><span class="content"><code class="idl highlight"><a data-link-type="idl" href="#performancelongtasktiming" id="ref-for-performancelongtasktiming-1">PerformanceLongTaskTiming</a></code> interface</span><a class="self-link" href="#sec-PerformanceLongTaskTiming"></a></h3>
<pre class="idl highlight def"><span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="performancelongtasktiming">PerformanceLongTaskTiming</dfn> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/performance-timeline-2/#the-performanceentry-interface">PerformanceEntry</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">FrozenArray</span>&lt;<a class="n" data-link-type="idl-name" href="#taskattributiontiming" id="ref-for-taskattributiontiming-1">TaskAttributionTiming</a>> <dfn class="nv dfn-paneled idl-code" data-dfn-for="PerformanceLongTaskTiming" data-dfn-type="attribute" data-export="" data-readonly="" data-type="FrozenArray<TaskAttributionTiming>" id="dom-performancelongtasktiming-attribution">attribution</dfn>;
};
</pre>
   <p><code class="idl highlight"><a data-link-type="idl" href="#performancelongtasktiming" id="ref-for-performancelongtasktiming-2">PerformanceLongTaskTiming</a></code> extends the following attributes of <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#the-performanceentry-interface">PerformanceEntry</a></code> interface:</p>
   <ul>
    <li data-md="">
     <p>The <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-name">name</a></code> attribute must return <code class="idl highlight"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></code> for minimal frame attribution. Possible values of name are:</p>
     <ul>
      <li data-md="">
       <p><code class="highlight">self</code>: long task is from within my own frame</p>
      <li data-md="">
       <p><code class="highlight">same<span class="o">-</span>origin<span class="o">-</span>ancestor</code>: long task is from a same-origin ancestor frame</p>
      <li data-md="">
       <p><code class="highlight">same<span class="o">-</span>origin<span class="o">-</span>descendant</code>: long task is from a same-origin descendant frame</p>
      <li data-md="">
       <p><code class="highlight">same<span class="o">-</span>origin</code>: long task is from an unreachable same-origin frame</p>
      <li data-md="">
       <p><code class="highlight">cross<span class="o">-</span>origin<span class="o">-</span>ancestor</code>: long task is from a cross-origin ancestor frame</p>
      <li data-md="">
       <p><code class="highlight">cross<span class="o">-</span>origin<span class="o">-</span>descendant</code>: long task is from a cross-origin descendant frame</p>
      <li data-md="">
       <p><code class="highlight">cross<span class="o">-</span>origin<span class="o">-</span>unreachable</code>: long task is from a cross-origin unreachable frame</p>
      <li data-md="">
       <p><code class="highlight">multiple<span class="o">-</span>contexts</code>: multiple frame contexts were involved in the long task</p>
      <li data-md="">
       <p><code class="highlight">unknown</code>: none of the above</p>
     </ul>
    <li data-md="">
     <p>The <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-entrytype">entryType</a></code> attribute must return <code class="highlight"><span class="s2">"longtask"</span></code>.</p>
    <li data-md="">
     <p>The <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-starttime">startTime</a></code> attribute MUST return a <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/hr-time-2/#idl-def-domhighrestimestampdomhighrestimestamp">DOMHighResTimeStamp</a></code> of when the task started.</p>
    <li data-md="">
     <p>The <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-duration">duration</a></code> attribute MUST return a <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/hr-time-2/#idl-def-domhighrestimestampdomhighrestimestamp">DOMHighResTimeStamp</a></code> equal to the elapsed time between the start and end of task</p>
   </ul>
   <p><code class="idl highlight"><a data-link-type="idl" href="#performancelongtasktiming" id="ref-for-performancelongtasktiming-3">PerformanceLongTaskTiming</a></code> adds the following attributes:</p>
   <ul>
    <li data-md="">
     <p>The <dfn class="idl-code" data-dfn-for="PerformanceEntry" data-dfn-type="attribute" data-export="" id="dom-performanceentry-attribution">attribution<a class="self-link" href="#dom-performanceentry-attribution"></a></dfn> field returns a sequence of <code class="idl highlight"><a data-link-type="idl" href="#taskattributiontiming" id="ref-for-taskattributiontiming-2">TaskAttributionTiming</a></code> entries.</p>
   </ul>
   <h3 class="heading settled" data-level="3.2" id="sec-TaskAttributionTiming"><span class="secno">3.2. </span><span class="content"><code class="idl highlight"><a data-link-type="idl" href="#taskattributiontiming" id="ref-for-taskattributiontiming-3">TaskAttributionTiming</a></code> interface</span><a class="self-link" href="#sec-TaskAttributionTiming"></a></h3>
<pre class="def idl highlight"><span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="taskattributiontiming">TaskAttributionTiming</dfn> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/performance-timeline-2/#the-performanceentry-interface">PerformanceEntry</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-taskattributiontiming-containertype" id="ref-for-dom-taskattributiontiming-containertype-1">containerType</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-taskattributiontiming-containersrc" id="ref-for-dom-taskattributiontiming-containersrc-1">containerSrc</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-taskattributiontiming-containerid" id="ref-for-dom-taskattributiontiming-containerid-1">containerId</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-taskattributiontiming-containername" id="ref-for-dom-taskattributiontiming-containername-1">containerName</a>;
};
</pre>
   <p><code class="idl highlight"><a data-link-type="idl" href="#taskattributiontiming" id="ref-for-taskattributiontiming-4">TaskAttributionTiming</a></code> extends the following attributes of <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#the-performanceentry-interface">PerformanceEntry</a></code> interface:</p>
   <ul>
    <li data-md="">
     <p>The <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-name">name</a></code> attribute must return <code class="idl highlight"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></code> indicating type of attribution. Currently this can <code class="highlight"><span class="s2">"script"</span></code>.</p>
    <li data-md="">
     <p>The <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-entrytype">entryType</a></code> attribute must return <code class="idl highlight"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></code> <code class="highlight"><span class="s2">"taskattribution"</span></code></p>
    <li data-md="">
     <p>The <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-starttime">startTime</a></code> attribute MUST return 0.</p>
    <li data-md="">
     <p>The <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-duration">duration</a></code> attribute MUST return 0.</p>
   </ul>
   <p><code class="idl highlight"><a data-link-type="idl" href="#taskattributiontiming" id="ref-for-taskattributiontiming-5">TaskAttributionTiming</a></code> adds the following attributes:</p>
   <ul>
    <li data-md="">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TaskAttributionTiming" data-dfn-type="attribute" data-export="" id="dom-taskattributiontiming-containertype">containerType</dfn> attribute must return <code class="idl highlight"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></code> with type of frame container, such as <code class="highlight"><span class="s2">"iframe"</span></code>, <code class="highlight"><span class="s2">"embed"</span></code>, <code class="highlight"><span class="s2">"object"</span></code>.</p>
    <li data-md="">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TaskAttributionTiming" data-dfn-type="attribute" data-export="" id="dom-taskattributiontiming-containername">containerName</dfn> attribute must return <code class="idl highlight"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></code> with containerâs <code class="highlight">name</code> attribute.</p>
    <li data-md="">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TaskAttributionTiming" data-dfn-type="attribute" data-export="" id="dom-taskattributiontiming-containerid">containerId</dfn> attribute must return <code class="idl highlight"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></code> with containerâs <code class="highlight">id</code> attribute.</p>
    <li data-md="">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TaskAttributionTiming" data-dfn-type="attribute" data-export="" id="dom-taskattributiontiming-containersrc">containerSrc</dfn> attribute must return <code class="idl highlight"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></code> with containerâs <code class="highlight">src</code> attribute.</p>
   </ul>
   <h3 class="heading settled" data-level="3.3" id="sec-PointingToCulprit"><span class="secno">3.3. </span><span class="content">Pointing to the culprit</span><a class="self-link" href="#sec-PointingToCulprit"></a></h3>
   <p>Long task represents the top level event loop task. Within this task, different types of work (such as script, layout, style etc) may be done, and they could be executed within different frame contexts. The type of work could also be global in nature such as a long GC that is process or frame-tree wide.</p>
   <p>Thus pointing to the culprit has couple of facets:</p>
   <ul>
    <li data-md="">
     <p>Pointing to the overall frame to blame for the long task on the whole: this is refered to as "minimal frame attribution" and is captured in the <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-name">name</a></code> field</p>
    <li data-md="">
     <p>Pointing to the type of work involved in the task, and its associated frame context: this is captured in <code class="idl highlight"><a data-link-type="idl" href="#taskattributiontiming" id="ref-for-taskattributiontiming-6">TaskAttributionTiming</a></code> objects in the <code class="idl highlight"><a data-link-type="idl" href="#dom-performancelongtasktiming-attribution" id="ref-for-dom-performancelongtasktiming-attribution-1">attribution</a></code> field of <code class="idl highlight"><a data-link-type="idl" href="#performancelongtasktiming" id="ref-for-performancelongtasktiming-4">PerformanceLongTaskTiming</a></code></p>
   </ul>
   <p>Therefore, <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-name">name</a></code> and <code class="idl highlight"><a data-link-type="idl" href="#dom-performancelongtasktiming-attribution" id="ref-for-dom-performancelongtasktiming-attribution-2">attribution</a></code> fields on <code class="idl highlight"><a data-link-type="idl" href="#performancelongtasktiming" id="ref-for-performancelongtasktiming-5">PerformanceLongTaskTiming</a></code> together paint the picture for where the blame rests for a long task.
When delivering this information the web origin-policy must be adhered to.</p>
   <p>As an illustration, the <code class="idl highlight"><a data-link-type="idl" href="#taskattributiontiming" id="ref-for-taskattributiontiming-7">TaskAttributionTiming</a></code> entry in <code class="idl highlight"><a data-link-type="idl" href="#dom-performancelongtasktiming-attribution" id="ref-for-dom-performancelongtasktiming-attribution-3">attribution</a></code> is populated with "script" work, and the container or frame implicated in attribution should match up with the <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-name">name</a></code> as follows:</p>
   <table>
    <thead>
     <tr>
      <th>value of <code class="idl highlight"><a data-link-type="idl" href="https://www.w3.org/TR/performance-timeline-2/#dom-performanceentry-name">name</a></code>
      <th>culprit frame implicated in <code class="idl highlight"><a data-link-type="idl" href="#dom-performancelongtasktiming-attribution" id="ref-for-dom-performancelongtasktiming-attribution-4">attribution</a></code>
    <tbody>
     <tr>
      <td><code class="highlight">self</code> 
      <td>empty 
     <tr>
      <td><code class="highlight">same<span class="o">-</span>origin<span class="o">-</span>ancestor</code> 
      <td>same-origin culprit frame 
     <tr>
      <td><code class="highlight">same<span class="o">-</span>origin<span class="o">-</span>descendant</code> 
      <td>same-origin culprit frame 
     <tr>
      <td><code class="highlight">same<span class="o">-</span>origin</code> 
      <td>same-origin culprit frame 
     <tr>
      <td><code class="highlight">cross<span class="o">-</span>origin<span class="o">-</span>ancestor</code> 
      <td>empty 
     <tr>
      <td><code class="highlight">cross<span class="o">-</span>origin<span class="o">-</span>descendant</code> 
      <td>empty 
     <tr>
      <td><code class="highlight">cross<span class="o">-</span>origin<span class="o">-</span>unreachable</code> 
      <td>empty 
     <tr>
      <td><code class="highlight">multiple<span class="o">-</span>contexts</code> 
      <td>empty 
     <tr>
      <td><code class="highlight">unknown</code> 
      <td>empty 
   </table>
   <h2 class="heading settled" data-level="4" id="sec-processing-model"><span class="secno">4. </span><span class="content">Processing Model</span><a class="self-link" href="#sec-processing-model"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="mod"><span class="secno">4.1. </span><span class="content">Modifications to other specifications</span><a class="self-link" href="#mod"></a></h3>
   <h4 class="heading settled" data-level="4.1.1" id="html-event-loop-dfn"><span class="secno">4.1.1. </span><span class="content">HTML: <a href="https://html.spec.whatwg.org/#definitions-3">event loop definitions</a></span><a class="self-link" href="#html-event-loop-dfn"></a></h4>
   <p>Each task gets an associated <i>start time</i>, <i>end time</i>, and a <i>script evaluation environment settings object set</i>.</p>
   <h4 class="heading settled" data-level="4.1.2" id="html-event-loop-processing"><span class="secno">4.1.2. </span><span class="content">HTML: <a href="">event loop processing model</a></span><a class="self-link" href="#html-event-loop-processing"></a></h4>
   <p>Before Step #3:</p>
   <ul>
    <li data-md="">
     <p>Set the selected taskâs start time to the value be the value that would be returned by the Performance objectâs now() method.</p>
   </ul>
   <p>After Step #3:</p>
   <ul>
    <li data-md="">
     <p>Set the selected taskâs end time to the value be the value that would be returned by the Performance objectâs now() method.</p>
    <li data-md="">
     <p>Execute the report long tasks algorithm (below), passing in the selected task.</p>
   </ul>
   <h4 class="heading settled" data-level="4.1.3" id="html-calling-scripts"><span class="secno">4.1.3. </span><span class="content">HTML: <a href="https://html.spec.whatwg.org/#calling-scripts">calling scripts</a></span><a class="self-link" href="#html-calling-scripts"></a></h4>
   <p>In prepare to run script, add a step at the end to add settings to the currently running taskâs script evaluation environment settings object set.</p>
   <h3 class="heading settled" data-level="4.2" id="sec-additions-to-spec"><span class="secno">4.2. </span><span class="content">Additions to the Long Task Spec</span><a class="self-link" href="#sec-additions-to-spec"></a></h3>
   <h4 class="heading settled" data-level="4.2.1" id="report-long-tasks"><span class="secno">4.2.1. </span><span class="content">Report Long Tasks</span><a class="self-link" href="#report-long-tasks"></a></h4>
   <p>Given a task task, perform the following algorithm:</p>
   <ol>
    <li data-md="">
     <p>If end time minus start time is less than the long tasks threshold of 50 ms, abort these steps.</p>
    <li data-md="">
     <p>Let destinationRealms be an empty set.</p>
    <li data-md="">
     <p>Determine the set of JavaScript Realms to which reports will be delivered:</p>
     <p>For each environment settings object settings in taskâs script evaluation environment settings object set:</p>
     <ol>
      <li data-md="">
       <p>Let topmostBC be settingsâs responsible browsing contextâs top-level browsing context.</p>
      <li data-md="">
       <p>Add topmostBCâs Windowâs relevant Realm to destinationRealms.</p>
      <li data-md="">
       <p>Let descendantBCs be topmostBCâs active documentâs list of descendant browsing contexts.</p>
      <li data-md="">
       <p>For each descendantBC in descendantBCs, add descendantBCâs Windowâs relevant Realm to destinationRealms.</p>
     </ol>
    <li data-md="">
     <p>For each destinationRealm in destinationRealms:</p>
     <ol>
      <li data-md="">
       <p>Let name be the empty string. This will be used to report minimal frame attribution, below.</p>
      <li data-md="">
       <p>Let culpritSettings be null.</p>
      <li data-md="">
       <p>Process taskâs script evaluation environment settings object set to determine name and culpritSettings as follows:</p>
       <ol>
        <li data-md="">
         <p>If taskâs script evaluation environment settings object set is empty: set name to âunknownâ and culpritSettings to null.</p>
        <li data-md="">
         <p>If taskâs script evaluation environment settings object setâs length is greater than one: set name to "multiple-contextsâ and culpritSettings to null.</p>
        <li data-md="">
         <p>If taskâs script evaluation environment settings object setâs length is one:</p>
         <ol>
          <li data-md="">
           <p>Set culpritSettings to the single item in taskâs script evaluation environment settings object set.</p>
          <li data-md="">
           <p>Let destinationOrigin be destinationRealmâs relevant settings objectâs origin.</p>
          <li data-md="">
           <p>Let destinationBC be destinationRealmâs relevant settings objectâs responsible browsing context.</p>
          <li data-md="">
           <p>If culpritSettingsâs origin and destinationOrigin are [same origin]:</p>
           <ol>
            <li data-md="">
             <p>If culpritSettingsâs responsible browsing context is an ancestor of destinationBC, set name to âsame-origin-ancestorâ.</p>
            <li data-md="">
             <p>If culpritSettingsâs responsible browsing context is a descendant of destinationBC, set name to âsame-origin-descendantâ.</p>
           </ol>
          <li data-md="">
           <p>Otherwise:</p>
           <ol>
            <li data-md="">
             <p>If culpritSettingsâs responsible browsing context is an ancestor of destinationBC, set name to âcross-origin-ancestorâ and set culpritSettings to null.</p>
             <p class="note" role="note"><span>NOTE:</span> this is not reported because of security. Developers should look this up themselves.</p>
            <li data-md="">
             <p>If culpritSettingsâs responsible browsing context is a descendant of destinationBC, set name to âcross-origin-descendantâ.</p>
           </ol>
         </ol>
       </ol>
     </ol>
    <li data-md="">
     <p>Create a new <code class="idl highlight"><a data-link-type="idl" href="#taskattributiontiming" id="ref-for-taskattributiontiming-8">TaskAttributionTiming</a></code> object attribution and set its attributes as follows:</p>
     <ol>
      <li data-md="">
       <p>Set attributionâs name attribute to "script".</p>
      <li data-md="">
       <p>Set attributionâs entryType attribute to âtaskattributionâ</p>
      <li data-md="">
       <p>Set attributionâs  startTime and duration to 0.</p>
      <li data-md="">
       <p>If culpritSettings is not null, and culpritSettingsâs responsible browsing context has a browsing context container that is an iframe element, then let iframe be that element, and perform the following steps:</p>
       <ol>
        <li data-md="">
         <p>Set attributionâs frameName attribute to the value of iframeâs name content attribute, or null if the attribute is absent.</p>
        <li data-md="">
         <p>Set attributionâs frameSrc attribute to the value of iframeâs src content attribute, or null if the attribute is absent.</p>
         <p class="note" role="note"><span>NOTE:</span> it is intentional that we record the frameâs src attribute here, and not its current URL, as this is meant primarily to help identify frames, and allowing discovery of the current URL of a cross-origin iframe is a security problem.</p>
        <li data-md="">
         <p>Set attributionâs frameId attribute to the value of iframeâs id content attribute, or null if the attribute is absent.</p>
       </ol>
     </ol>
    <li data-md="">
     <p>Create a new <code class="idl highlight"><a data-link-type="idl" href="#performancelongtasktiming" id="ref-for-performancelongtasktiming-6">PerformanceLongTaskTiming</a></code> object newEntry and set its attributes as follows:</p>
     <ol>
      <li data-md="">
       <p>Set newEntryâs name attribute to name.</p>
      <li data-md="">
       <p>Set newEntryâs entryType attribute to âlongtaskâ</p>
      <li data-md="">
       <p>Set newEntryâs startTime attribute to start time</p>
      <li data-md="">
       <p>Set newEntryâs duration attribute to end time minus start time</p>
      <li data-md="">
       <p>Set newEntryâs attribution attribute to a new frozen array containing the single value attribution.</p>
       <p class="note" role="note"><span>NOTE:</span> future iterations of this API may add more values to the attribution attribute, but for now it only contains a single value.</p>
     </ol>
    <li data-md="">
     <p><a href="https://w3c.github.io/performance-timeline/#dfn-queue-a-performanceentry">Queue the PerformanceEntry</a> newEntry on destinationRealm.</p>
     <p class="note" role="note"><span>NOTE:</span> the "queue a PerformanceEntry" algorithm will end up doing nothing if no observers are registered. Implementations likely will want to bail out from this algorithm earlier in that case, instead of assembling all the above information only to find out nobody is listening for it.</p>
   </ol>
   <h2 class="heading settled" data-level="5" id="priv-sec"><span class="secno">5. </span><span class="content">Security and Privacy Considerations</span><a class="self-link" href="#priv-sec"></a></h2>
   <p>Long Tasks API adheres to cross-origin policy by including origin-safe attribution information about the source of the long task.
There is a 50ms threshold for long tasks, also timing info provided is clamped to 1ms resolution. Together this provides adequate protection against security attacks against browser.</p>
   <p>However, privacy related attacks are possible, while the API doesnât introduce any new privacy attacks, it could make existing privacy attacks faster. Mitigations for this are possible and discussed in the security review <a href="https://docs.google.com/document/d/1tIMI1gau_q6X5EBnjDNiFS5NWV9cpYJ5KKA7xPd3VB8/edit">in this document.</a></p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words âMUSTâ, âMUST NOTâ, âREQUIREDâ, âSHALLâ, âSHALL NOTâ, âSHOULDâ, âSHOULD NOTâ, âRECOMMENDEDâ, âMAYâ, and âOPTIONALâ
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words âfor exampleâ
            or are set apart from the normative text with <code class="highlight"><span class="kr">class</span><span class="o">=</span><span class="s2">"example"</span></code>, like this: </p>
   <div class="example" id="example-ae2b6bc0"><a class="self-link" href="#example-ae2b6bc0"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word âNoteâ
            and are set apart from the normative text with <code class="highlight"><span class="kr">class</span><span class="o">=</span><span class="s2">"note"</span></code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note. </p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">â</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">â</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">â</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Donât scroll to compensate for the ToC if weâre above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I donât know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldnât exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isnât standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we donât have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While weâre at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Canât find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li>
    attribution
    <ul>
     <li><a href="#dom-performancelongtasktiming-attribution">attribute for PerformanceLongTaskTiming</a><span>, in Â§3.1</span>
     <li><a href="#dom-performanceentry-attribution">attribute for PerformanceEntry</a><span>, in Â§3.1</span>
    </ul>
   <li><a href="#attribution">Attribution</a><span>, in Â§2</span>
   <li><a href="#dom-taskattributiontiming-containerid">containerId</a><span>, in Â§3.2</span>
   <li><a href="#dom-taskattributiontiming-containername">containerName</a><span>, in Â§3.2</span>
   <li><a href="#dom-taskattributiontiming-containersrc">containerSrc</a><span>, in Â§3.2</span>
   <li><a href="#dom-taskattributiontiming-containertype">containerType</a><span>, in Â§3.2</span>
   <li><a href="#culprit-frame">Culprit frame</a><span>, in Â§2</span>
   <li><a href="#frame">Frame</a><span>, in Â§2</span>
   <li><a href="#frame-context">frame context</a><span>, in Â§2</span>
   <li><a href="#long-task">Long task</a><span>, in Â§2</span>
   <li><a href="#performancelongtasktiming">PerformanceLongTaskTiming</a><span>, in Â§3.1</span>
   <li><a href="#taskattributiontiming">TaskAttributionTiming</a><span>, in Â§3.2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def"><span class="kt">interface</span> <a class="nv" href="#performancelongtasktiming">PerformanceLongTaskTiming</a> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/performance-timeline-2/#the-performanceentry-interface">PerformanceEntry</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">FrozenArray</span>&lt;<a class="n" data-link-type="idl-name" href="#taskattributiontiming">TaskAttributionTiming</a>> <a class="nv" data-readonly="" data-type="FrozenArray<TaskAttributionTiming>" href="#dom-performancelongtasktiming-attribution">attribution</a>;
};

<span class="kt">interface</span> <a class="nv" href="#taskattributiontiming">TaskAttributionTiming</a> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/performance-timeline-2/#the-performanceentry-interface">PerformanceEntry</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-taskattributiontiming-containertype">containerType</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-taskattributiontiming-containersrc">containerSrc</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-taskattributiontiming-containerid">containerId</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-taskattributiontiming-containername">containerName</a>;
};

</pre>
  <aside class="dfn-panel" data-for="performancelongtasktiming">
   <b><a href="#performancelongtasktiming">#performancelongtasktiming</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-performancelongtasktiming-1">3.1. PerformanceLongTaskTiming interface</a> <a href="#ref-for-performancelongtasktiming-2">(2)</a> <a href="#ref-for-performancelongtasktiming-3">(3)</a>
    <li><a href="#ref-for-performancelongtasktiming-4">3.3. Pointing to the culprit</a> <a href="#ref-for-performancelongtasktiming-5">(2)</a>
    <li><a href="#ref-for-performancelongtasktiming-6">4.2.1. Report Long Tasks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-performancelongtasktiming-attribution">
   <b><a href="#dom-performancelongtasktiming-attribution">#dom-performancelongtasktiming-attribution</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-performancelongtasktiming-attribution-1">3.3. Pointing to the culprit</a> <a href="#ref-for-dom-performancelongtasktiming-attribution-2">(2)</a> <a href="#ref-for-dom-performancelongtasktiming-attribution-3">(3)</a> <a href="#ref-for-dom-performancelongtasktiming-attribution-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="taskattributiontiming">
   <b><a href="#taskattributiontiming">#taskattributiontiming</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-taskattributiontiming-1">3.1. PerformanceLongTaskTiming interface</a> <a href="#ref-for-taskattributiontiming-2">(2)</a>
    <li><a href="#ref-for-taskattributiontiming-3">3.2. TaskAttributionTiming interface</a> <a href="#ref-for-taskattributiontiming-4">(2)</a> <a href="#ref-for-taskattributiontiming-5">(3)</a>
    <li><a href="#ref-for-taskattributiontiming-6">3.3. Pointing to the culprit</a> <a href="#ref-for-taskattributiontiming-7">(2)</a>
    <li><a href="#ref-for-taskattributiontiming-8">4.2.1. Report Long Tasks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-taskattributiontiming-containertype">
   <b><a href="#dom-taskattributiontiming-containertype">#dom-taskattributiontiming-containertype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-taskattributiontiming-containertype-1">3.2. TaskAttributionTiming interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-taskattributiontiming-containername">
   <b><a href="#dom-taskattributiontiming-containername">#dom-taskattributiontiming-containername</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-taskattributiontiming-containername-1">3.2. TaskAttributionTiming interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-taskattributiontiming-containerid">
   <b><a href="#dom-taskattributiontiming-containerid">#dom-taskattributiontiming-containerid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-taskattributiontiming-containerid-1">3.2. TaskAttributionTiming interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-taskattributiontiming-containersrc">
   <b><a href="#dom-taskattributiontiming-containersrc">#dom-taskattributiontiming-containersrc</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-taskattributiontiming-containersrc-1">3.2. TaskAttributionTiming interface</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>